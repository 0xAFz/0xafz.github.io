<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deploy DNS Tunnels with Smuggler | AFz</title><meta name=keywords content><meta name=description content="توی این آموزش میخوایم با استفاده از پروژه smuggler تونل dnstt و slipstream بیاریم بالا
پیش‌نیاز های این آموزش
۱. ما نیاز به حداقل یه سرور خارج از ایران (آلمان، هلند، و &mldr;) داریم (Debian/Ubuntu/RedHat/Fedora)
۲. حداقل یه domain ترجیحا روی Cloudflare
۳. برای استفاده از smuggler حتما باید یه سیستم لینوکسی در نقش کنترلر داشته باشیم
۴. برای راحتی پیشنهاد میشه که از کد ادیتور‌ هایی مثل vscode استفاده کنید موقع کانفیگ کردن پروژه"><meta name=author content><link rel=canonical href=https://0xafz.github.io/posts/deploy-dns-tunnels-with-smuggler/><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=https://0xafz.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://0xafz.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0xafz.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://0xafz.github.io/apple-touch-icon.png><link rel=mask-icon href=https://0xafz.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://0xafz.github.io/posts/deploy-dns-tunnels-with-smuggler/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel=stylesheet><style>body{font-family:vazirmatn,sans-serif}body{direction:rtl;text-align:right}pre,code{direction:ltr;text-align:left;font-family:jetbrains mono,monospace!important}</style><meta property="og:url" content="https://0xafz.github.io/posts/deploy-dns-tunnels-with-smuggler/"><meta property="og:site_name" content="AFz"><meta property="og:title" content="Deploy DNS Tunnels with Smuggler"><meta property="og:description" content="توی این آموزش میخوایم با استفاده از پروژه smuggler تونل dnstt و slipstream بیاریم بالا
پیش‌نیاز های این آموزش ۱. ما نیاز به حداقل یه سرور خارج از ایران (آلمان، هلند، و …) داریم (Debian/Ubuntu/RedHat/Fedora)
۲. حداقل یه domain ترجیحا روی Cloudflare
۳. برای استفاده از smuggler حتما باید یه سیستم لینوکسی در نقش کنترلر داشته باشیم
۴. برای راحتی پیشنهاد میشه که از کد ادیتور‌ هایی مثل vscode استفاده کنید موقع کانفیگ کردن پروژه"><meta property="og:locale" content="fa"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-05T10:07:56+03:30"><meta property="article:modified_time" content="2026-02-05T10:07:56+03:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploy DNS Tunnels with Smuggler"><meta name=twitter:description content="توی این آموزش میخوایم با استفاده از پروژه smuggler تونل dnstt و slipstream بیاریم بالا
پیش‌نیاز های این آموزش
۱. ما نیاز به حداقل یه سرور خارج از ایران (آلمان، هلند، و &mldr;) داریم (Debian/Ubuntu/RedHat/Fedora)
۲. حداقل یه domain ترجیحا روی Cloudflare
۳. برای استفاده از smuggler حتما باید یه سیستم لینوکسی در نقش کنترلر داشته باشیم
۴. برای راحتی پیشنهاد میشه که از کد ادیتور‌ هایی مثل vscode استفاده کنید موقع کانفیگ کردن پروژه"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://0xafz.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Deploy DNS Tunnels with Smuggler","item":"https://0xafz.github.io/posts/deploy-dns-tunnels-with-smuggler/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deploy DNS Tunnels with Smuggler","name":"Deploy DNS Tunnels with Smuggler","description":"توی این آموزش میخوایم با استفاده از پروژه smuggler تونل dnstt و slipstream بیاریم بالا\nپیش‌نیاز های این آموزش ۱. ما نیاز به حداقل یه سرور خارج از ایران (آلمان، هلند، و \u0026hellip;) داریم (Debian/Ubuntu/RedHat/Fedora)\n۲. حداقل یه domain ترجیحا روی Cloudflare\n۳. برای استفاده از smuggler حتما باید یه سیستم لینوکسی در نقش کنترلر داشته باشیم\n۴. برای راحتی پیشنهاد میشه که از کد ادیتور‌ هایی مثل vscode استفاده کنید موقع کانفیگ کردن پروژه\n","keywords":[],"articleBody":"توی این آموزش میخوایم با استفاده از پروژه smuggler تونل dnstt و slipstream بیاریم بالا\nپیش‌نیاز های این آموزش ۱. ما نیاز به حداقل یه سرور خارج از ایران (آلمان، هلند، و …) داریم (Debian/Ubuntu/RedHat/Fedora)\n۲. حداقل یه domain ترجیحا روی Cloudflare\n۳. برای استفاده از smuggler حتما باید یه سیستم لینوکسی در نقش کنترلر داشته باشیم\n۴. برای راحتی پیشنهاد میشه که از کد ادیتور‌ هایی مثل vscode استفاده کنید موقع کانفیگ کردن پروژه\nاگه Windows دارید می‌تونید از WSL2 استفاده کنید برای اینکه یه سیستم لینوکسی داخل ویندوز داشته باشید (با یه سرچ ساده می‌تونید نصبش کنید)\nاگه Mac دارید می‌تونید از ترمینال خودش استفاده کنید\nنصب پیش‌نیاز ها توی اولین قدم باید Ansible و Git رو نصب کنیم روی کنترلر\nبرای Windows (WSL2):\n# Debian/Ubuntu sudo apt update sudo apt install ansible git -y # RedHat/Fedora sudo dnf install ansible git -y برای Mac:\nbrew install ansible git برای Linux:\n# Debian/Ubuntu sudo apt update sudo apt install ansible git -y # RedHat/Fedora sudo dnf install ansible git -y # Arch-based sudo pacman -Syy ansible git بعد از نصب کردن پیش‌نیاز ها می‌ریم سراغ پروژه smuggler پروژه رو کلون می‌گیریم:\ngit clone https://github.com/vayzur/smuggler.git وارد مسیر پروژه می‌شیم:\ncd smuggler/ حالا یه ls میزنیم تا ببینیم چیا داریم:\nls توی خروجی باید فایل‌های پروژه رو ببینید:\nLICENSE README.md ansible.cfg docs inventory playbooks resolvers.txt roles scan.sh smuggler.yml توی این آموزش ما فقط و فقط باید ۲ تا فایل توی مسیر های مشخص بسازیم و به بقیه چیزا کار نداریم\nمسیر فایل اول که داخلش آیپی و اسم سرور‌هامون رو باید تعریف کنیم:\ninventory/hosts.yml مسیر فایل دوم که داخلش باید تونل‌هارو تعریف کنیم:\ninventory/group_vars/all/tunnels.yml یعنی ساختار باید اینجوری باشه:\ninventory ├── group_vars │ ├── all │ │ ├── examples.yml │ │ └── tunnels.yml ├── hosts.yml └── sample.yml فایل‌های hosts.yml و tunnels.yml از قبل وجود ندارن و باید بسازیم\nاینجا حالا اگه vscode دارید پروژه رو باهاش باز کنید:\ncode . اگه vscode ندارید می‌تونید با هر ادیتوری این فایل هارو بسازید ولی حتما یادتون باشه که چون ساختار فایل‌ها YAML هست:\nباید حتما indent رو رعایت کنید و حتی اگه یدونه space اشتباه بزنید ممکنه به مشکل بخورید\nتوی فایل hosts.yml باید آدرس سرور‌ها رو مشخص کنیم و یه اسم براشون بذاریم تا توی فایل بعدی از اسمشون استفاده کنیم\nمثال ساده:\nall: hosts: node0: ansible_host: 203.0.113.10 ansible_port: 22 ansible_user: root ansible_password: \"your_server_password\" children: server_nodes: hosts: node0: همینطور که می‌بینید من یه سرور تعریف کردم به اسم node0 و با آیپی 203.0.113.10\nپورت ssh که پیش‌فرض 22 هست و یوزر root\nnode0: ansible_host: 203.0.113.10 ansible_port: 22 ansible_user: root ansible_password: \"your_server_password\" یوزر باید دسترسی sudo یا root داشته باشه برای راه‌اندازی تونل‌ها\nنکته بعدی درمورد password‌ هست، اگه از ssh keys استفاده می‌کنید نیاز ندارید اینجا پسورد بذارید و می‌تونید این خط رو حذف کنید\nاما اگر مبتدی هستید و یا به هر دلیلی نمی‌خواید از ssh keys استفاده کنید، می‌تونید پسورد سرور رو براش مشخص کنید:\nansible_password: \"your_server_password\" حالا باید سروری که تعریف کردیم رو به گروه server_nodes اضافه کنیم:\nchildren: server_nodes: hosts: node0: هر سروری که تعریف می‌کنیم و قراره که تو نقش DNS tunnel server باشه باید به server_nodes اضافه بشه وگرنه smuggler متوجه نمیشه\nمثال از دوتا سرور:\nall: hosts: node0: ansible_host: 203.0.113.10 ansible_port: 22 ansible_user: root ansible_password: \"your_server_password\" node1: ansible_host: 203.0.113.20 ansible_port: 22 ansible_user: root ansible_password: \"your_server_password\" children: server_nodes: hosts: node0: node1: حالا همون مثال ساده‌ رو توی inventory/hosts.yml کپی کنید\nو آیپی سرور، یوزر، پسورد و پورت رو با مقدار‌هایی که برای سرور خودتون هست جایگزین کنید\nبعد از اینکه فایل hosts.yml رو ساختیم و سرور هامون رو داخلش تعریف کردیم\nمیریم سراغ tunnels.yml که تونل‌هامون رو تعریف کنیم\nنکته: درحال حاضر هر سرور فقط می‌تونه یه نوع تونل در لحظه داشته باشه یا dnstt یا slipstream، نمیشه جفتشون باهم روی یدونه سرور بیاد بالا (علتشم اینه که پورت 53 که مال DNS هست فقط یدونه هست)\nپس به اینکه کدوم نوع تونل رو دیپلوی می‌کنید روی سرور دقت کنید تا به مشکل نخورید\nخب تونل‌هارو داخل فایل inventory/group_vars/all/tunnels.yml رو با این ساختار تعریف می‌کنیم:\ntunnels: - name: tun0 server_node: node0 engine: dnstt domain: t.example.com هر تونل ۴ تا فیلد اجباری داره که حتما باید مشخص بشن\nاولین فیلد name هست که یه اسم یکتا برای تونل باید مشخص کنیم (نباید با بقیه تونل‌ها یکی باشه)\nفیلد server_node مشخص کننده سروری که داخل hosts.yml تعریف کردیم هست و اشاره می‌کنه به اینکه روی کدوم سروری که داخل hosts.yml هست میخوایم این تونل بیاد بالا\nفیلد engine مشخص کننده نوع تونل هست و فقط دوتا مقدار رو پشتیبانی می‌کنه dnstt یا slipstream\nو در آخر فیلد domain که باید همون NS record که روی پنل DNS خودتون برای سرور اضافه کردید باشه\nاگه DNS Record‌هارو هنوز روی پنل خودتون اضافه نکردید حتما این‌کارو بکنید\ntns.example.com A 203.0.113.10 t.example.com NS tns.example.com. بعد از اینکه تونل‌هارو تعریف کردیم حالا می‌تونیم دیپلوی کنیم:\nansible-playbook -i inventory/hosts.yml smuggler.yml و الان باید ببینید که smuggler داره تونل‌هارو میاره بالا\nاگه اول کار به مشکل خوردید و یا connection ارور گرفتید فایل hosts.yml رو چک کنید تا ببینید چیزی اشتباه نباشه\nو اما درمورد پروکسی یا target که وقتی پکت‌ها از کلاینت به سرور رسیدن به کجا فروارد می‌شن\nپروژه smuggler از پورت‌های پیش‌فرض هر تونل استفاده می‌کنه\nبرای slipstream پورت target روی 5201 ست شده\nو برای dnstt روی 7000\nاگر می خواید پورت هدف رو تغییر بدید تا تونل پکت‌هارو به مقصد دیگه‌ای فروارد کنه باید تونل‌هارو رو آپدیت کنید:\ntunnels: - name: tun0 server_node: node0 engine: dnstt domain: t.example.com server: target_port: 8080 بعد از تغییر دادن تونل‌ها توی فایل tunnels.yml حتما باید این تغییرات رو روی سرور هم اعمال کنیم:\nansible-playbook -i inventory/hosts.yml smuggler.yml --tags server-tunnels اینجوری فقط تونل‌ها آپدیت می‌شن و به همین سادگی مقصد پکت‌ها تغییر می‌کنه\nپروکسی به طور کلی پروژه smuggler هدفش فقط راه اندازی DNS tunneling هست و قرار نیست proxy بیاره بالا\nیعنی شما از قبل باید یه پروکسی روی اون پورت مقصد بیارید بالا و بعدش تونل‌هارو راه اندازی کنید\nپروکسی می‌تونه هرچیزی که TCP هست باشه مثل: Xray, Sing-box, SSH socks, و …\nاینم اضافه کنم که پروژه smuggler درحال حاضر می‌تونه SSH socks proxy هم بیاره بالا\nو برای استفاده از این قابلیت کافیه که تونل‌های خودتون رو به این صورت آپدیت کنید:\nاول از هر چیزی باید ssh_proxy رو فعال کنیم(پیش‌فرض غیرفعال هست):\nssh_proxy: true و یه فیلد proxy به تونل اضافه کنیم:\nssh_proxy: true tunnels: - name: tun0 server_node: node0 engine: dnstt domain: t.example.com server: target_port: 8080 proxy: - name: proxy1 remote_addr: 127.0.0.1 remote_port: 22 حالا می‌تونیم به smuggler بگیم تا پروکسی رو هم بیاره بالا:\nansible-playbook -i inventory/hosts.yml smuggler.yml --tags proxy اینو بگم که socks proxy اصلا گذینه امنی نیست چون encryption نداره و یا حتی authentication\nفقط برای تست یا استفاده شخصی ازش استفاده کنید\nروی پروداکشن از پروکسی‌هایی مثل Xray, Sing-box, Shadowsocks, و … استفاده کنید که امن تر باشن\nچجوری وصل بشیم؟ توی این آموزش فقط برای دسکتاپ مثال می‌زنیم که چجوری میشه وصل شد\nنیاز داریم باینری‌های dnstt-client یا slipstream-client رو روی دسکتاپ خودمون داشته باشیم\nبرای dnstt رو می‌تونید از این لینک دانلود کنید: dnstt\nو برای slipstream از این اینجا: slipstream\nاگه تونل dnstt هست نیاز داریم که public key که برای تونل هست رو به کلاینت بدیم\nپروژه smuggler به طور پیش‌فرض private key و public key رو داخل این مسیر قرار میده:\n/opt/dnstt.key # private key /opt/dnstt.pub # public key یه بار ssh بزنید به سرور و اونو کپی کنید:\ncat /opt/dnstt.pub # abcd... قبل از ران کردن کلاینت مطمئن بشید که قابلیت اجرایی داره:\nchmod +x dnstt-client و حالا کلاینت رو ران کنید:\ndnstt-client -udp 8.8.8.8:53 -pubkey 4d77f7e4... t.example.com 127.0.0.1:1080 بعد از اینکه کلاینت رو ران کردید برای تست اینکه تونل کار می‌کنه یا نه\nیه HTTP request بهش می‌زنیم:\ncurl --proxy socks5h://127.0.0.1:1080 http://ifconfig.me # 203.0.113.10 اگه ریکوست با موفق از تونل رد بشه باید IP سرور خودتون رو بهتون برگردونه\nو اگه تونل slipstream آوردید بالا به همین صورت:\nchmod +x slipstream-client کلاینت رو ران کنید:\nslipstream-client -l 1080 -r 8.8.8.8:53 -d t.example.com -t 200 و یه ریکوست بهش بزنید:\ncurl --proxy socks5h://127.0.0.1:1080 http://ifconfig.me # 203.0.113.10 علت اینکه ما اینجا از پروکسی نوع socks استفاده کردیم این بود که بالاتر گفتیم که می‌تونیم از SSH socks proxy برای تست استفاده کنیم\nمی‌تونید با مرورگر یا تلگرام هم بهش کانکت بشید\nچجوری تونل رو از روی سرور حذف کنیم؟ ۱. برای دیدن وضعیت سرویس اون تونل:\nsystemctl status smuggler@tun0.service ۲. برای stop کردن تونل:\nsystemctl stop smuggler@tun0.service ۳. برای restart کردن تونل:\nsystemctl restart smuggler@tun0.service ۴. حذف کردن تونل از روی سرور:\nsystemctl stop smuggler@*.service rm /etc/systemd/system/smuggler@*.service systemctl daemon-reload ۵. حذف کردن پروکسی‌ها از روی سرور:\nsystemctl stop proxy@*.service rm /etc/systemd/system/proxy@*.service systemctl daemon-reload اینجا * به معنی اسم اون تونل هست و اگه همین رو بزنید در واقع تمام تونل‌ها یا پروکسی‌ها حذف می‌شن\nاگه خواستید بیشتر با پروژه آشنا بشید می‌تونید به داکیومنت پروژه مراجعه کنید: smuggler\n","wordCount":"1470","inLanguage":"en","datePublished":"2026-02-05T10:07:56+03:30","dateModified":"2026-02-05T10:07:56+03:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://0xafz.github.io/posts/deploy-dns-tunnels-with-smuggler/"},"publisher":{"@type":"Organization","name":"AFz","logo":{"@type":"ImageObject","url":"https://0xafz.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://0xafz.github.io/ accesskey=h title="AFz (Alt + H)">AFz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Deploy DNS Tunnels with Smuggler</h1><div class=post-meta><span title='2026-02-05 10:07:56 +0330 +0330'>February 5, 2026</span></div></header><div class=post-content><p>توی این آموزش میخوایم با استفاده از پروژه smuggler تونل <strong>dnstt</strong> و <strong>slipstream</strong> بیاریم بالا</p><h3 id=پیشنیاز-های-این-آموزش>پیش‌نیاز های این آموزش<a hidden class=anchor aria-hidden=true href=#پیشنیاز-های-این-آموزش>#</a></h3><p>۱. ما نیاز به حداقل یه سرور خارج از ایران (آلمان، هلند، و &mldr;) داریم (Debian/Ubuntu/RedHat/Fedora)<br>۲. حداقل یه domain ترجیحا روی Cloudflare<br>۳. برای استفاده از smuggler حتما باید یه سیستم لینوکسی در نقش کنترلر داشته باشیم<br>۴. برای راحتی پیشنهاد میشه که از کد ادیتور‌ هایی مثل <strong>vscode</strong> استفاده کنید موقع کانفیگ کردن پروژه</p><blockquote><p>اگه Windows دارید می‌تونید از <strong>WSL2</strong> استفاده کنید برای اینکه یه سیستم لینوکسی داخل ویندوز داشته باشید (با یه سرچ ساده می‌تونید نصبش کنید)</p></blockquote><blockquote><p>اگه Mac دارید می‌تونید از ترمینال خودش استفاده کنید</p></blockquote><h2 id=نصب-پیشنیاز-ها>نصب پیش‌نیاز ها<a hidden class=anchor aria-hidden=true href=#نصب-پیشنیاز-ها>#</a></h2><p>توی اولین قدم باید Ansible و Git رو نصب کنیم روی کنترلر<br>برای Windows (<strong>WSL2</strong>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Debian/Ubuntu</span>
</span></span><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install ansible git -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RedHat/Fedora</span>
</span></span><span style=display:flex><span>sudo dnf install ansible git -y
</span></span></code></pre></div><p>برای Mac:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install ansible git
</span></span></code></pre></div><p>برای Linux:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Debian/Ubuntu</span>
</span></span><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install ansible git -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RedHat/Fedora</span>
</span></span><span style=display:flex><span>sudo dnf install ansible git -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Arch-based</span>
</span></span><span style=display:flex><span>sudo pacman -Syy ansible git
</span></span></code></pre></div><p>بعد از نصب کردن پیش‌نیاز ها می‌ریم سراغ پروژه smuggler
پروژه رو کلون می‌گیریم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/vayzur/smuggler.git
</span></span></code></pre></div><p>وارد مسیر پروژه می‌شیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd smuggler/
</span></span></code></pre></div><p>حالا یه ls میزنیم تا ببینیم چیا داریم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls
</span></span></code></pre></div><p>توی خروجی باید فایل‌های پروژه رو ببینید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>LICENSE  README.md  ansible.cfg  docs  inventory  playbooks  resolvers.txt  roles  scan.sh  smuggler.yml
</span></span></code></pre></div><p>توی این آموزش ما فقط و فقط باید ۲ تا فایل توی مسیر های مشخص بسازیم و به بقیه چیزا کار نداریم</p><p>مسیر فایل اول که داخلش آیپی و اسم سرور‌هامون رو باید تعریف کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>inventory/hosts.yml
</span></span></code></pre></div><p>مسیر فایل دوم که داخلش باید تونل‌هارو تعریف کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>inventory/group_vars/all/tunnels.yml
</span></span></code></pre></div><p>یعنی ساختار باید اینجوری باشه:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>inventory
</span></span><span style=display:flex><span>├── group_vars
</span></span><span style=display:flex><span>│   ├── all
</span></span><span style=display:flex><span>│   │   ├── examples.yml
</span></span><span style=display:flex><span>│   │   └── tunnels.yml
</span></span><span style=display:flex><span>├── hosts.yml
</span></span><span style=display:flex><span>└── sample.yml
</span></span></code></pre></div><p>فایل‌های <code>hosts.yml</code> و <code>tunnels.yml </code>از قبل وجود ندارن و باید بسازیم<br>اینجا حالا اگه <strong>vscode</strong> دارید پروژه رو باهاش باز کنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>code .
</span></span></code></pre></div><p>اگه <strong>vscode</strong> ندارید می‌تونید با هر ادیتوری این فایل هارو بسازید ولی حتما یادتون باشه که چون ساختار فایل‌ها <strong>YAML</strong> هست:</p><blockquote><p>باید حتما <strong>indent</strong> رو رعایت کنید و حتی اگه یدونه <strong>space</strong> اشتباه بزنید ممکنه به مشکل بخورید</p></blockquote><p>توی فایل <code>hosts.yml</code> باید آدرس سرور‌ها رو مشخص کنیم و یه اسم براشون بذاریم تا توی فایل بعدی از اسمشون استفاده کنیم<br>مثال ساده:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>all</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>node0</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>203.0.113.10</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_user</span>: <span style=color:#ae81ff>root</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_password</span>: <span style=color:#e6db74>&#34;your_server_password&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>children</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_nodes</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>node0</span>:
</span></span></code></pre></div><p>همینطور که می‌بینید من یه سرور تعریف کردم به اسم <code>node0</code> و با آیپی <code>203.0.113.10</code><br>پورت ssh که پیش‌فرض <code>22</code> هست و یوزر <code>root</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>    <span style=color:#f92672>node0</span>:
</span></span><span style=display:flex><span>     <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>203.0.113.10</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>ansible_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>ansible_user</span>: <span style=color:#ae81ff>root</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>ansible_password</span>: <span style=color:#e6db74>&#34;your_server_password&#34;</span>
</span></span></code></pre></div><blockquote><p>یوزر باید دسترسی <strong>sudo</strong> یا root <strong>داشته</strong> باشه برای راه‌اندازی تونل‌ها</p></blockquote><p>نکته بعدی درمورد password‌ هست، اگه از ssh keys استفاده می‌کنید نیاز ندارید اینجا پسورد بذارید و می‌تونید این خط رو حذف کنید<br>اما اگر مبتدی هستید و یا به هر دلیلی نمی‌خواید از ssh keys استفاده کنید، می‌تونید پسورد سرور رو براش مشخص کنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>ansible_password</span>: <span style=color:#e6db74>&#34;your_server_password&#34;</span>
</span></span></code></pre></div><p>حالا باید سروری که تعریف کردیم رو به گروه server_nodes اضافه کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>children</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_nodes</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>node0</span>:
</span></span></code></pre></div><p>هر سروری که تعریف می‌کنیم و قراره که تو نقش DNS tunnel server باشه باید به server_nodes اضافه بشه وگرنه smuggler متوجه نمیشه</p><p>مثال از دوتا سرور:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>all</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>node0</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>203.0.113.10</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_user</span>: <span style=color:#ae81ff>root</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_password</span>: <span style=color:#e6db74>&#34;your_server_password&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>node1</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>203.0.113.20</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_user</span>: <span style=color:#ae81ff>root</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_password</span>: <span style=color:#e6db74>&#34;your_server_password&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>children</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_nodes</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>node0</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>node1</span>:
</span></span></code></pre></div><p>حالا همون مثال ساده‌ رو توی <code>inventory/hosts.yml</code> کپی کنید<br>و <strong>آیپی سرور، یوزر، پسورد و پورت</strong> رو با مقدار‌هایی که برای سرور خودتون هست جایگزین کنید</p><p>بعد از اینکه فایل <code>hosts.yml</code> رو ساختیم و سرور هامون رو داخلش تعریف کردیم<br>میریم سراغ <code>tunnels.yml</code> که تونل‌هامون رو تعریف کنیم</p><blockquote><p>نکته: درحال حاضر هر سرور فقط می‌تونه یه نوع تونل در لحظه داشته باشه یا <strong>dnstt</strong> یا <strong>slipstream</strong>، نمیشه جفتشون باهم روی یدونه سرور بیاد بالا (علتشم اینه که پورت <code>53</code> که مال <strong>DNS</strong> هست فقط یدونه هست)<br>پس به اینکه کدوم نوع تونل رو دیپلوی می‌کنید روی سرور دقت کنید تا به مشکل نخورید</p></blockquote><p>خب تونل‌هارو داخل فایل <code>inventory/group_vars/all/tunnels.yml</code> رو با این ساختار تعریف می‌کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>tunnels</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tun0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_node</span>: <span style=color:#ae81ff>node0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>engine</span>: <span style=color:#ae81ff>dnstt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>domain</span>: <span style=color:#ae81ff>t.example.com</span>
</span></span></code></pre></div><p>هر تونل ۴ تا فیلد اجباری داره که حتما باید مشخص بشن<br>اولین فیلد <code>name</code> هست که یه اسم یکتا برای تونل باید مشخص کنیم (نباید با بقیه تونل‌ها یکی باشه)<br>فیلد <code>server_node</code> مشخص کننده سروری که داخل <code>hosts.yml</code> تعریف کردیم هست و اشاره می‌کنه به اینکه روی کدوم سروری که داخل <code>hosts.yml</code> هست میخوایم این تونل بیاد بالا<br>فیلد <code>engine</code> مشخص کننده نوع تونل هست و فقط دوتا مقدار رو پشتیبانی می‌کنه <code>dnstt</code> یا <code>slipstream</code><br>و در آخر فیلد <code>domain</code> که باید همون <strong>NS record</strong> که روی پنل <strong>DNS</strong> خودتون برای سرور اضافه کردید باشه</p><blockquote><p>اگه DNS Record‌هارو هنوز روی پنل خودتون اضافه نکردید حتما این‌کارو بکنید</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>tns.example.com A 203.0.113.10
</span></span><span style=display:flex><span>t.example.com NS tns.example.com.
</span></span></code></pre></div><p>بعد از اینکه تونل‌هارو تعریف کردیم حالا می‌تونیم دیپلوی کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible-playbook -i inventory/hosts.yml smuggler.yml
</span></span></code></pre></div><p>و الان باید ببینید که smuggler داره تونل‌هارو میاره بالا<br>اگه اول کار به مشکل خوردید و یا connection ارور گرفتید فایل <code>hosts.yml</code> رو چک کنید تا ببینید چیزی اشتباه نباشه</p><p>و اما درمورد پروکسی یا target که وقتی پکت‌ها از کلاینت به سرور رسیدن به کجا فروارد می‌شن<br>پروژه smuggler از پورت‌های پیش‌فرض هر تونل استفاده می‌کنه<br>برای <strong>slipstream</strong> پورت <code>target</code> روی <code>5201</code> ست شده<br>و برای <strong>dnstt</strong> روی <code>7000</code></p><p>اگر می خواید پورت هدف رو تغییر بدید تا تونل پکت‌هارو به مقصد دیگه‌ای فروارد کنه
باید تونل‌هارو رو آپدیت کنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>tunnels</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tun0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_node</span>: <span style=color:#ae81ff>node0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>engine</span>: <span style=color:#ae81ff>dnstt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>domain</span>: <span style=color:#ae81ff>t.example.com</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>:
</span></span><span style=display:flex><span>	  <span style=color:#f92672>target_port</span>: <span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><p>بعد از تغییر دادن تونل‌ها توی فایل <code>tunnels.yml</code> حتما باید این تغییرات رو روی سرور هم اعمال کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible-playbook -i inventory/hosts.yml smuggler.yml --tags server-tunnels
</span></span></code></pre></div><p>اینجوری فقط تونل‌ها آپدیت می‌شن
و به همین سادگی مقصد پکت‌ها تغییر می‌کنه</p><h2 id=پروکسی>پروکسی<a hidden class=anchor aria-hidden=true href=#پروکسی>#</a></h2><p>به طور کلی پروژه smuggler هدفش فقط راه اندازی DNS tunneling هست و قرار نیست proxy بیاره بالا<br>یعنی شما از قبل باید یه پروکسی روی اون پورت مقصد بیارید بالا و بعدش تونل‌هارو راه اندازی کنید<br>پروکسی می‌تونه هرچیزی که TCP هست باشه مثل: Xray, Sing-box, SSH socks, و &mldr;</p><p>اینم اضافه کنم که پروژه smuggler درحال حاضر می‌تونه SSH socks proxy هم بیاره بالا<br>و برای استفاده از این قابلیت کافیه که تونل‌های خودتون رو به این صورت آپدیت کنید:</p><p>اول از هر چیزی باید <code>ssh_proxy</code> رو فعال کنیم(پیش‌فرض غیرفعال هست):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>ssh_proxy</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>و یه فیلد proxy به تونل اضافه کنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>ssh_proxy</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>tunnels</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>tun0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_node</span>: <span style=color:#ae81ff>node0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>engine</span>: <span style=color:#ae81ff>dnstt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>domain</span>: <span style=color:#ae81ff>t.example.com</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>:
</span></span><span style=display:flex><span>	  <span style=color:#f92672>target_port</span>: <span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>proxy</span>:
</span></span><span style=display:flex><span>	    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>proxy1</span>
</span></span><span style=display:flex><span>	      <span style=color:#f92672>remote_addr</span>: <span style=color:#ae81ff>127.0.0.1</span>
</span></span><span style=display:flex><span>	      <span style=color:#f92672>remote_port</span>: <span style=color:#ae81ff>22</span>
</span></span></code></pre></div><p>حالا می‌تونیم به smuggler بگیم تا پروکسی رو هم بیاره بالا:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible-playbook -i inventory/hosts.yml smuggler.yml --tags proxy
</span></span></code></pre></div><blockquote><p>اینو بگم که socks proxy اصلا گذینه امنی نیست چون encryption نداره و یا حتی authentication<br>فقط برای تست یا استفاده شخصی ازش استفاده کنید<br>روی پروداکشن از پروکسی‌هایی مثل Xray, Sing-box, Shadowsocks, و &mldr; استفاده کنید که امن تر باشن</p></blockquote><h2 id=چجوری-وصل-بشیم>چجوری وصل بشیم؟<a hidden class=anchor aria-hidden=true href=#چجوری-وصل-بشیم>#</a></h2><p>توی این آموزش فقط برای دسکتاپ مثال می‌زنیم که چجوری میشه وصل شد</p><p>نیاز داریم باینری‌های <code>dnstt-client</code> یا <code>slipstream-client</code> رو روی دسکتاپ خودمون داشته باشیم<br>برای dnstt رو می‌تونید از این لینک دانلود کنید: <a href=https://github.com/net2share/dnstt/releases/tag/latest>dnstt</a></p><p>و برای slipstream از این اینجا: <a href=https://github.com/net2share/slipstream-rust-build/releases/tag/latest>slipstream</a></p><p>اگه تونل dnstt هست نیاز داریم که public key که برای تونل هست رو به کلاینت بدیم<br>پروژه smuggler به طور پیش‌فرض private key و public key رو داخل این مسیر قرار میده:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/opt/dnstt.key <span style=color:#75715e># private key</span>
</span></span><span style=display:flex><span>/opt/dnstt.pub <span style=color:#75715e># public key</span>
</span></span></code></pre></div><p>یه بار ssh بزنید به سرور و اونو کپی کنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /opt/dnstt.pub
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># abcd...</span>
</span></span></code></pre></div><p>قبل از ران کردن کلاینت مطمئن بشید که قابلیت اجرایی داره:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x dnstt-client
</span></span></code></pre></div><p>و حالا کلاینت رو ران کنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dnstt-client -udp 8.8.8.8:53 -pubkey 4d77f7e4... t.example.com 127.0.0.1:1080
</span></span></code></pre></div><p>بعد از اینکه کلاینت رو ران کردید برای تست اینکه تونل کار می‌کنه یا نه<br>یه <strong>HTTP request</strong> بهش می‌زنیم:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --proxy socks5h://127.0.0.1:1080 http://ifconfig.me
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 203.0.113.10</span>
</span></span></code></pre></div><p>اگه ریکوست با موفق از تونل رد بشه باید IP سرور خودتون رو بهتون برگردونه</p><p>و اگه تونل slipstream آوردید بالا به همین صورت:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x slipstream-client
</span></span></code></pre></div><p>کلاینت رو ران کنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>slipstream-client -l <span style=color:#ae81ff>1080</span> -r 8.8.8.8:53 -d t.example.com -t <span style=color:#ae81ff>200</span>
</span></span></code></pre></div><p>و یه ریکوست بهش بزنید:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --proxy socks5h://127.0.0.1:1080 http://ifconfig.me
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 203.0.113.10</span>
</span></span></code></pre></div><p>علت اینکه ما اینجا از پروکسی نوع socks استفاده کردیم این بود که بالاتر گفتیم که می‌تونیم از SSH socks proxy برای تست استفاده کنیم<br>می‌تونید با مرورگر یا تلگرام هم بهش کانکت بشید</p><h2 id=چجوری-تونل-رو-از-روی-سرور-حذف-کنیم>چجوری تونل رو از روی سرور حذف کنیم؟<a hidden class=anchor aria-hidden=true href=#چجوری-تونل-رو-از-روی-سرور-حذف-کنیم>#</a></h2><p>۱. برای دیدن وضعیت سرویس اون تونل:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl status smuggler@tun0.service
</span></span></code></pre></div><p>۲. برای stop کردن تونل:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl stop smuggler@tun0.service
</span></span></code></pre></div><p>۳. برای restart کردن تونل:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl restart smuggler@tun0.service
</span></span></code></pre></div><p>۴. حذف کردن تونل از روی سرور:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl stop smuggler@*.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rm /etc/systemd/system/smuggler@*.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>systemctl daemon-reload
</span></span></code></pre></div><p>۵. حذف کردن پروکسی‌ها از روی سرور:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl stop proxy@*.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>rm /etc/systemd/system/proxy@*.service
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>systemctl daemon-reload
</span></span></code></pre></div><blockquote><p>اینجا <code>*</code> به معنی اسم اون تونل هست و اگه همین رو بزنید در واقع تمام تونل‌ها یا پروکسی‌ها حذف می‌شن</p></blockquote><p>اگه خواستید بیشتر با پروژه آشنا بشید می‌تونید به داکیومنت پروژه مراجعه کنید:
<a href=https://github.com/vayzur/smuggler>smuggler</a></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://0xafz.github.io/>AFz</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>